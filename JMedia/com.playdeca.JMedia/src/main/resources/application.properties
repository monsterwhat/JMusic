# Datasource
quarkus.datasource.db-kind=h2 
quarkus.datasource.jdbc.url=jdbc:h2:file:${user.home}/.jmedia/jmedia;DB_CLOSE_DELAY=-1 
quarkus.datasource.username=sa
quarkus.datasource.password=
quarkus.log.category."org.h2".level=WARN

# For HTTP - Running behind reverse proxy
quarkus.http.host=0.0.0.0
quarkus.http.port=8080
quarkus.http.idle-timeout=30m
quarkus.http.enable-compression=false

# Disable SSL locally (handled by reverse proxy)
quarkus.http.insecure-requests=enabled

# Reverse Proxy Configuration - IMPORTANT for WebSocket and URL generation
quarkus.http.proxy.proxy-address-forwarding=true
quarkus.http.proxy.allow-x-forwarded=true
quarkus.http.proxy.enable-forwarded-host=true
quarkus.http.proxy.enable-forwarded-prefix=true

# CORS Configuration
quarkus.http.cors=true
quarkus.http.cors.origins=http://localhost:8080,http://127.0.0.1:8080,http://192.168.100.99:8080,https://music.playdeca.com
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=*
quarkus.http.cors.credentials=true

# Security Headers
quarkus.http.header."X-Frame-Options"=DENY
quarkus.http.header."X-Content-Type-Options"=nosniff
quarkus.http.header."X-XSS-Protection"="1; mode=block"
quarkus.http.header."Content-Security-Policy"="default-src 'self'; img-src 'self' data: blob:; media-src 'self' blob:; style-src 'self' 'unsafe-inline'; script-src 'self'"

# Hibernate ORM
quarkus.hibernate-orm.schema-management.strategy=update
quarkus.hibernate-orm.log.sql=false

# Transaction Management
quarkus.transaction-manager.default-transaction-timeout=300

# Native image configuration for H2
quarkus.native.additional-build-args=--initialize-at-run-time=org.h2.server.TcpServer,--initialize-at-run-time=org.h2.server.web.WebServer

# Authentication and Session Configuration
quarkus.http.auth.form.enabled=true
quarkus.http.auth.session.timeout=30d
quarkus.http.auth.session.cookie-secure=true
quarkus.http.auth.session.cookie-http-only=true
quarkus.http.auth.session.cookie-same-site=lax
quarkus.http.auth.form.cookie-name=JMEDIA_SESSION
quarkus.http.auth.form.login-page=/login.html
quarkus.http.auth.form.redirect-url=/
